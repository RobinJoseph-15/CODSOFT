# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1H3ZoakGRQA5HRjZ7Zt-xnjLmrb7oOPUH
"""

import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report

from google.colab import drive
drive.mount('/content/drive')

"""File paths (Google Drive)"""

train_path = "/content/drive/MyDrive/codsoft dataset/Genre Classification Dataset/train_data.txt"
test_path = "/content/drive/MyDrive/codsoft dataset/Genre Classification Dataset/test_data.txt"
test_solution_path = "/content/drive/MyDrive/codsoft dataset/Genre Classification Dataset/test_data_solution.txt"

"""Load Training Data"""

train_data = []

with open(train_path, "r", encoding="utf-8") as f:
    for line in f:
        parts = line.strip().split(" ::: ")
        train_data.append([parts[2], parts[3]])

train_df = pd.DataFrame(train_data, columns=["genre", "plot"])

"""Load Testing Data"""

test_data = []

with open(test_path, "r", encoding="utf-8") as f_test, open(test_solution_path, "r", encoding="utf-8") as f_sol:
    for test_line, sol_line in zip(f_test, f_sol):
        test_parts = test_line.strip().split(" ::: ")
        sol_parts = sol_line.strip().split(" ::: ")
        test_data.append([sol_parts[2], test_parts[2]])

test_df = pd.DataFrame(test_data, columns=["genre", "plot"])

"""Feature Extraction"""

vectorizer = TfidfVectorizer(stop_words='english', max_df=0.7)

X_train = vectorizer.fit_transform(train_df["plot"])
X_test = vectorizer.transform(test_df["plot"])

y_train = train_df["genre"]
y_test = test_df["genre"]

"""Train Model"""

model = MultinomialNB()
model.fit(X_train, y_train)

"""Test Model"""

y_pred = model.predict(X_test)

print("Accuracy:", accuracy_score(y_test, y_pred))
print("\nConfusion Matrix:\n", confusion_matrix(y_test, y_pred))
print("\nClassification Report:\n", classification_report(y_test, y_pred))

"""Predict Genre (User Input)

"""

plot = input("\nEnter a movie plot: ")
plot_vector = vectorizer.transform([plot])
prediction = model.predict(plot_vector)

print("\nPredicted Genre:", prediction[0])